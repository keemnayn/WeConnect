<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.arezip.weconnect.mapper.NoticeMapper">
	<select id="selectAllNotices"
		resultType="com.arezip.weconnect.model.dto.NoticeDTO">
		select
		notice_title AS noticeTitle,
		notice_content AS
		noticeContent,
		notice_category AS noticeCategory,
		TO_CHAR(notice_create, 'YYYY-MM-DD') AS noticeCreate
		from notice
		ORDER
		BY notice_id DESC
	</select>
	<insert id="insertNotice"
		parameterType="com.arezip.weconnect.model.dto.NoticeDTO">
		insert into notice (notice_id, notice_title,
		notice_content,
		notice_category, member_id)
		values (notice_seq.nextval,
		#{noticeTitle}, #{noticeContent},
		#{noticeCategory},
		#{memberVO.memberId})
	</insert>
	<update id="updateNotice"
		parameterType="com.arezip.weconnect.model.dto.NoticeDTO">
		UPDATE notice
		SET notice_title = #{noticeTitle},
		notice_content = #{noticeContent},
		notice_category = #{noticeCategory}
		WHERE notice_id = #{noticeId}
	</update>
	<delete id="deleteNotice" parameterType="long">
		delete from notice where
		notice_id = #{noticeId}
	</delete>

	<select id="selectNoticesBySearchCriteria" parameterType="map"
		resultType="com.arezip.weconnect.model.dto.NoticeDTO">
		SELECT * FROM notice
		WHERE 1=1
		<choose>
			<!-- 전체 검색일 경우 -->
			<when test="searchType == 'all'">
				AND (notice_title LIKE '%' || #{searchText} || '%' OR
				notice_category
				LIKE '%' || #{searchText} || '%')
			</when>
			<!-- 제목으로만 검색할 경우 -->
			<when test="searchType == 'title'">
				AND notice_title LIKE '%' || #{searchText} || '%'
			</when>
			<!-- 공지사항 분류로 검색할 경우 -->
			<when test="searchType == 'category'">
				AND notice_category LIKE '%' || #{searchText} || '%'
			</when>
		</choose>
		ORDER BY notice_create DESC
	</select>
</mapper>