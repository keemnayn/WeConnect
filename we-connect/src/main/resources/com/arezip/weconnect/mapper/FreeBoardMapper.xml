<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.arezip.weconnect.mapper.FreeBoardMapper">

	<!-- <resultMap id="FreeBoardResultMap" type="com.arezip.weconnect.model.vo.FreeBoardVO"> 
		<result property="freeBoardId" column="freeBoardId" /> <result property="freeBoardTitle" 
		column="freeBoardTitle" /> <result property="memberVO.memberName" column="memberName" 
		/> <result property="freeBoardCreate" column="freeBoardCreate" /> </resultMap> 
		<select id="getFreeBoardList" resultMap="FreeBoardResultMap"> SELECT f.free_board_id 
		as freeBoardId, f.free_board_title as freeBoardTitle, m.member_name as memberName, 
		to_char(f.free_board_create, 'YYYY-MM-DD') as freeBoardCreate FROM free_board 
		f JOIN member m ON f.member_id = m.member_id </select> -->

	<!-- <resultMap id="FreeBoardResultMap" type="com.arezip.weconnect.model.vo.FreeBoardVO"> 
		<id property="freeBoardId" column="free_board_id" /> <result property="freeBoardTitle" 
		column="free_board_title" /> <result property="freeBoardCreate" column="free_board_create" 
		/> <association property="memberVO" javaType="com.arezip.weconnect.model.vo.MemberVO"> 
		<result property="memberName" column="member_name" /> </association> </resultMap> 
		<select id="getFreeBoardList" resultMap="FreeBoardResultMap"> select f.free_board_id, 
		f.free_board_title, m.member_name, f.free_board_create from free_board f 
		join member m on f.member_id = m.member_id </select> -->

	<select id="getFreeBoardList" resultType="com.arezip.weconnect.model.dto.FreeBoardDTO">		    
		select f.free_board_id as freeBoardId, f.free_board_title as freeBoardTitle,f.free_board_content as freeBoardContent, 
		m.member_name as memberName, to_char(f.free_board_create,'YYYY-MM-DD') as freeBoardCreate
		from free_board f join member m 
		on f.member_id = m.member_id     
	</select>
	
	<select id="getFreeBoardDetail" resultType="com.arezip.weconnect.model.dto.FreeBoardDTO">
		SELECT 
		    f.free_board_id, 
		    f.free_board_title, 
		    f.free_board_content, 
		    f.free_board_create, 
		    f.free_board_views, 
		    f.free_board_file_name,
		    m.member_name
		FROM free_board f JOIN member m ON f.member_id = m.member_id
		WHERE f.free_board_id = #{freeBoardId}
	</select>
	
	<select id="getFreeBoardDetailComment" resultType="com.arezip.weconnect.model.dto.FreeBoardCommentDTO">
		select f.free_board_id, fc.free_board_comment_id, fc.free_board_comment_content, 
			to_char( fc.free_board_comment_date,'YYYY-MM-DD') as freeBoardCommentDate
		    ,m.member_name
		FROM free_board f JOIN member m ON f.member_id = m.member_id
		JOIN free_board_comment fc ON f.free_board_id = fc.free_board_id
		WHERE f.free_board_id = #{freeBoardId}
	</select>
	
	<insert id="insertFreeBoard" parameterType="com.arezip.weconnect.model.dto.FreeBoardDTO">
		insert into free_board(free_board_id, free_board_title, free_board_content, free_board_file_name, member_id)
	    values(free_board_seq.nextval, #{freeBoardTitle}, #{freeBoardContent},
	        <choose>
	            <when test="freeBoardFileName != null">#{freeBoardFileName}</when>
	            <otherwise>null</otherwise>
	        </choose>,
	        #{memberId})
	</insert>
</mapper>